Ansible

1. Create Ansible SSH key 


ssh-keygen -t ed25519 -C "Ansible key"

save it in /home/afzaal/.ssh/ansiblekey

do not generate a passphrase



copy ansible public key to all of the servers to be managed


ssh-copy-id -i ~/.ssh/ansiblekey.pub 172.18.233.15


check the anible key on the servers

cat ~/.ssh/authorized_keys


make an SSH connection using ansible key

ssh -i ~/.ssh/ansiblekey 172.18.233.15


2. Create inventory file (Enter Ip Addresses OR DNS Names of the all servers to be managed)

192.168.10.1
192.168.10.2
192.168.10.3
192.168.10.4
192.168.10.5


3. Make a connection to all of the servers inside the Inventory file

ansible all --key-file ~/.ssh/ansiblekey -i inventory -m ping

Check for Success Messges


4. Create Ansible config file   

ansible.cfg

[defaults]
inventory = inventory
private_key_file = ~/.ssh/ansiblekey


5. Run ansible command again but witout key and inventory

ansible all -m ping


6. ansible all --list-hosts



get all infomtaion about the hosts = Processors, OS, Envinroment varible etc.

7. ansible all -m gather_facts


ansible all -m gather_facts --limit 192.168.10.5

ansible all -m gather_facts --limit 192.168.10.5 | grep anisble_distribution

Update All Servers/Hosts


Run Apt Update command on the hosts with Sudo Priviliges and password

8. ansible all -m apt -a update_cahce=true --become --ask-become-pass


install nano

9. ansible all -m apt -a name=nano --become --ask-become-pass




upgrade all packges on all servers


9a. ansible all -m apt -a "upgrade=dist" --become --ask-become-pass




10. ansible all -m apt -a name=snapd --become --ask-become-pass


for more than one argument we need double quote""

ansible all -m apt -a "name=snapd state=latest" --become --ask-become-pass



11. install_apache.yml

ansible-playbook --asks-become-pass install_apache.yml


when run playbook:

it will geather gather facts

install packges

Play recap



/etc/ansible/hosts






